---
title: "STAT/MATH 495: Problem Set 09"
author: "MERON GEDRAGO"
date: "2017-11-07"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 2
    collapsed: false
    smooth_scroll: false
    df_print: kable
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE, fig.width=8, fig.height=4.5, message=FALSE, warning = FALSE
  )
set.seed(76)

library(tidyverse)
library(lattice)
```



# Collaboration

Please indicate who you collaborated with on this assignment: 



# Question 1: Run k-means

```{r}
observations_1 <- read_csv("data/observations_1.csv")

plot(observations_1$x1,observations_1$x2)
observations_2 <- read_csv("data/observations_2.csv")

#plot(observations_2$x1,observations_2$x2)
 

# Set observations to be one of two datasets
observations <- observations_1
 

# Fit model for k=2
 
k <- 2
k_means_results$iter = 10
k_means_results <- kmeans(observations,centers=k, iter.max = 10  )
clusters <- k_means_results$cluster

cluster_centers <- k_means_results$centers



# Add cluster results to observations. Note we convert to factor since cluster
# ID's should be treated as categorical
observations$cluster <- as.factor(clusters)

# Add cluster ID's to cluster_centers
cluster_centers <- cluster_centers %>% 
  as_tibble() %>% 
  mutate(cluster=as.factor(1:k))

ggplot(NULL, aes(x=x1, y=x2, col=cluster)) +
  geom_point(data=observations) +
  geom_point(data=cluster_centers, size=5)
```

```{r}
observations <- observations_2

plot(observations_2$x1,observations_2$x2)
# Fit model for k=2
 
k <- 2
k_means_results$iter = 10
k_means_results <- kmeans(observations,centers=k, iter.max = 10  )
clusters <- k_means_results$cluster

cluster_centers <- k_means_results$centers



# Add cluster results to observations. Note we convert to factor since cluster
# ID's should be treated as categorical
observations$cluster <- as.factor(clusters)

# Add cluster ID's to cluster_centers
cluster_centers <- cluster_centers %>% 
  as_tibble() %>% 
  mutate(cluster=as.factor(1:k))

ggplot(NULL, aes(x=x1, y=x2, col=cluster)) +
  geom_point(data=observations) +
  geom_point(data=cluster_centers, size=5)
```


**Questions**:

1. Run KMC 10 times on `observations_1` and comment on the consistency of the
results.

The within cluster variation seems to be the same the the one with 
1. Speculate on the root cause of any consistency or inconsistency in the
results.
1. Run KMC 10 times on `observations_2` and comment on the consistency of the
results.
1. Speculate on the root cause of any consistency or inconsistency in the
results.

**Answers**:

1. The graph shows that there is a low variation within cluster while there is also low variation between the two clusters. This makes the kmc less efficient because we cant distinguish between clusters that distinctly. 
1.The result on the graph is caused by the 'random' relationship that the two x1 and x2 variables have. We can look at our first plot of x1 vs x2 where we see the randomness and scattering of the points everywhere which causes for the clusters to not be defined well.  
1.The graph shows that there is a low variation within cluster while there is also high variation between the two clusters. This makes the kmc of 'observation_2' more efficient because we can distinguish between clusters distinctly. 
1. When we take a look at the normal plot of the x1 and x2 variables on a graph, we can clear see a linear relationship between the two variables. We also can see two clusters on the plot before looking at the plot from kmc, where one is at the top right and the other is on left bottom. Thus, the relatively well defined clusters in kmc for observation 2 is caused by the linear relationship the two variables x1 and x2 have. 



# Bonus question: Code your own

Read ISLR page 388 Algorithm 10.1 and implement k-means clustering from scratch.
Don't worry about doing it for general $k$; keep it simple and do it for $k=2$
specifically. Apply it to `observations_2` from above.

```{r}
# Hint:
library(proxy)
#assign k=2 to the 
A <- data_frame(
  x1 = c(0, 0.5, 0.75, 1),
  x2 = c(0, 0.5, 0.75, 1)
)
B <- data_frame(
  x1 = c(1, 0),
  x2 = c(1, 0)
)
#calculating the distance between the points 
distance_matrix <- proxy::dist(x=A, y=B)
distance_matrix
#find the minium distance between the points   
apply(distance_matrix, 1, which.min)

#assign numbers from 1 to K , to each of the observations 
 
```











